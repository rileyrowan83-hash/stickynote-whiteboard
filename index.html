<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sticky Notes</title>
<style>
:root{
  --bg:#eef2f6; --board:#fffef9; --muted:#6b6e73; --ink:#0b0b0c;
  --shadow:0 18px 40px rgba(10,10,12,0.08);
  --match-glow:0 0 26px rgba(180,80,200,0.18);
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;-webkit-font-smoothing:antialiased}
body{background:linear-gradient(180deg,#f3f6f9,#eef2f6);padding:18px;display:flex;justify-content:center;color:var(--ink)}
.container{width:100%;max-width:1300px;display:grid;grid-template-columns:1fr 380px;gap:20px;align-items:start}
.board{background:var(--board);border-radius:12px;padding:20px;min-height:80vh;box-shadow:var(--shadow);border:1px solid rgba(0,0,0,0.04);position:relative;overflow:auto;cursor:pointer}
.board h1{margin:0;font-size:28px}
.controls{display:flex;gap:8px;margin-bottom:12px}
.btn{padding:8px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
.btn.ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}
.btn.primary{background:#111827;color:#fff}
.notes-area{position:relative;width:100%;min-height:72vh;border-radius:10px;background:linear-gradient(180deg,#fbfbfb,#fffef8);border:1px dashed rgba(0,0,0,0.03);overflow:auto;padding:8px}
.note{position:absolute;width:180px;min-height:120px;padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fff8d6);box-shadow:0 10px 28px rgba(0,0,0,0.08);border:1px solid rgba(0,0,0,0.04);transform-origin:center;touch-action:none;transition:box-shadow .22s,transform .12s}
.note.match{box-shadow:var(--match-glow);transform:scale(1.03)}
.note .note-content{outline:none;white-space:pre-wrap;word-break:break-word;font-size:14px;line-height:1.2}
.note .note-meta{display:flex;justify-content:flex-end;margin-top:8px;font-size:12px}
.note .note-meta button{background:transparent;border:none;color:var(--muted);cursor:pointer;font-weight:600}
.note::before{content:"";position:absolute;left:12px;top:-8px;width:56px;height:12px;background:linear-gradient(90deg, rgba(255,255,255,0.6), rgba(255,255,255,0.2));border-radius:4px;transform:rotate(-4deg)}
.side{min-height:80vh}
.sticky-control{background:linear-gradient(180deg,#fff,#fff);padding:12px;border-radius:12px;box-shadow:var(--shadow);border:1px solid rgba(0,0,0,0.06)}
textarea#inputNote{width:100%;min-height:96px;resize:vertical;padding:10px;border-radius:8px;border:1px dashed rgba(0,0,0,0.06);font-family:inherit}
.tiny-login{position:fixed;right:12px;top:8px;font-size:12px;padding:6px 8px;border-radius:6px;background:transparent;border:1px solid rgba(0,0,0,0.06);color:var(--muted);cursor:default;z-index:60;opacity:0.95}
.tiny-login.enabled{background:#111827;color:#fff;cursor:pointer}
.overlay{position:fixed;inset:0;display:none;place-items:center;background:linear-gradient(180deg, rgba(8,8,9,0.6), rgba(8,8,9,0.86));z-index:90;backdrop-filter:blur(4px);color:#cfe8ff}
.panel{width:min(760px,94%);max-height:86vh;overflow:auto;background:linear-gradient(180deg,#07080a,#050405);border-radius:10px;padding:22px;font-family:monospace;font-size:15px;color:#cfe8ff;line-height:1.5}
.closeX{position:absolute;right:14px;top:10px;background:transparent;border:none;color:#dbe;font-size:18px;cursor:pointer}
.matrix-screen{position:fixed;inset:0;background:#000;color:#0f0;font-family:monospace;font-size:20px;padding:24px;white-space:pre;display:none;z-index:100;overflow:auto;}
</style>
</head>
<body>
<button id="loginBtn" class="tiny-login" title="Login (disabled)">Login</button>

<div class="container">
  <main class="board" id="board">
    <h1>Sticky Notes</h1>

    <div class="controls">
      <button id="addBtn" class="btn ghost">+ New Note</button>
      <button id="exportBtn" class="btn">Export</button>
      <button id="importBtn" class="btn ghost">Import</button>
      <button id="clearBtn" class="btn" style="background:#f3f4f6;color:#111;border:1px solid rgba(0,0,0,0.04);">Clear All</button>
    </div>

    <div id="notesArea" class="notes-area"></div>
    <footer class="small"></footer>
  </main>

  <aside class="side">
    <div class="sticky-control">
      <textarea id="inputNote" placeholder="Write a note..."></textarea>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
        <button id="submitBtn" class="btn primary">Add</button>
      </div>
    </div>
  </aside>
</div>

<div id="overlay" class="overlay" aria-hidden="true">
  <div class="panel" role="document">
    <button id="closeOverlay" class="closeX" title="Close">âœ•</button>
    <pre id="overlayText" style="white-space:pre-wrap;margin:0;"></pre>
  </div>
</div>

<div id="matrixScreen" class="matrix-screen"></div>

<script>
const STORAGE_KEY = 'sticky_notes_app_v2';
const SECRET_PHRASE = "It is coming, but I will not allow it to succeed.";

function genId(){ return 'n_' + Math.random().toString(36).slice(2,10); }
function loadNotes(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; }catch(e){ return []; } }
function saveNotes(notes){ localStorage.setItem(STORAGE_KEY, JSON.stringify(notes)); }
function trimOnly(s){ return (s || '').trim(); }

const notesArea = document.getElementById('notesArea');
const addBtn = document.getElementById('addBtn');
const exportBtn = document.getElementById('exportBtn');
const importBtn = document.getElementById('importBtn');
const clearBtn = document.getElementById('clearBtn');
const inputNote = document.getElementById('inputNote');
const submitBtn = document.getElementById('submitBtn');
const loginBtn = document.getElementById('loginBtn');
const overlay = document.getElementById('overlay');
const overlayText = document.getElementById('overlayText');
const closeOverlay = document.getElementById('closeOverlay');
const matrixScreen = document.getElementById('matrixScreen');

let dragging = null;
let offset = { x:0, y:0 };
let unlocked = false;

/* Note CRUD */
function createNoteElement(note){
  const el = document.createElement('div');
  el.className = 'note';
  el.style.left = (note.x || 20) + 'px';
  el.style.top  = (note.y || 20) + 'px';
  el.style.transform = `rotate(${note.rot || (Math.random()*6-3)}deg)`;
  el
